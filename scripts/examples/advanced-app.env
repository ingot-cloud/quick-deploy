# ==============================================================================
# 高级应用配置示例
# 展示如何使用 --ip, --add-host, --device, --cap-add 等高级参数
# ==============================================================================

# ==================== 基本配置 ====================
CONTAINER_NAME="advanced-app"
IMAGE_NAME="nginx:alpine"
CONTAINER_HOSTNAME="advanced-app.local"
RESTART_POLICY="unless-stopped"

# ==================== 网络配置 ====================
# 使用自定义网络和静态 IP
# 首先创建网络: docker network create --subnet=172.20.0.0/16 custom-net
NETWORK_NAME="custom-net"
CONTAINER_IP="172.20.0.100"

# ==================== 端口映射 ====================
PORTS="8080:80"

# ==================== 环境变量 ====================
ENV_VARS="
TZ=Asia/Shanghai
APP_ENV=production
"

# ==================== 卷挂载 ====================
VOLUMES="
/data/app:/app
"

# ==================== 资源限制 ====================
CPU_LIMIT="1.5"
CPU_SHARES="1024"
MEMORY_LIMIT="1g"
MEMORY_RESERVATION="512m"

# ==================== 健康检查 ====================
HEALTH_CHECK_ENABLED="true"
HEALTH_CHECK_CMD="curl -f http://localhost/ || exit 1"
HEALTH_CHECK_INTERVAL="30s"
HEALTH_CHECK_TIMEOUT="5s"
HEALTH_CHECK_RETRIES="3"

# ==================== 日志配置 ====================
LOG_DRIVER="json-file"
LOG_MAX_SIZE="20m"
LOG_MAX_FILE="5"

# ==================== 主机名映射 ====================
# 添加多个主机名映射
EXTRA_HOSTS="
192.168.1.10:database.local
192.168.1.11:cache.local
192.168.1.12:api.local
10.0.0.5:external-service.com
"

# ==================== DNS 配置 ====================
DNS_SERVERS="8.8.8.8 1.1.1.1"
DNS_SEARCH="mycompany.local local"

# ==================== 安全配置 ====================
# 添加 Linux Capabilities
CAP_ADD="NET_ADMIN SYS_TIME"

# 删除不需要的 Capabilities
CAP_DROP="MKNOD"

# SELinux 或 AppArmor 配置
# SECURITY_OPT="label=disable"

# ==================== 设备映射 ====================
# 映射主机设备到容器（例如 GPU、USB 设备等）
# 格式: host_device:container_device[:permissions]
DEVICES="
/dev/video0:/dev/video0:rwm
"

# ==================== 命名空间配置 ====================
# 使用主机的 PID 命名空间（可以看到主机所有进程）
# PID_MODE="host"

# 使用主机的 IPC 命名空间
# IPC_MODE="host"

# ==================== 其他配置 ====================
LABELS="
app=advanced-app
version=1.0.0
environment=production
team=devops
"

# 时区挂载
MOUNT_TIMEZONE="true"

# ==================== 系统调用配置 ====================
# 在执行脚本中可以添加 --sysctl 参数
# 例如: --sysctl net.ipv4.ip_forward=1
SYSCTL_PARAMS="
net.ipv4.ip_forward=1
net.core.somaxconn=65535
"

# ==================== 其他高级参数 ====================
# 在这里可以添加任何配置文件不支持的参数
# 这些参数会在执行脚本中使用
ULIMIT_NOFILE="65536"
ULIMIT_NPROC="8192"

